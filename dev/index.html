<html>
<head>
<meta charset="UTF-8">
<title>Cauliflower v0.1</title>

<!-- for jquery -->
<link rel="stylesheet" href="jquery/css//jquery-ui-1.8.22.custom.css" />
<script type="text/javascript" src="jquery/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="jquery/jquery-ui-1.8.22.custom.min.js"></script>
<script type="text/javascript" src="jquery/jquery.cookie.js"></script>
<script type="text/javascript">
<!--
	$(function() {
		$('#tabs').tabs({
			cookie : {
				expires : 3　//選択タブをcookieで3日間保存
			}
		});
	});
// -->
</script>
<style type=text/css>
.CodeMirror {
	position: relative;
	width: 50%;
}

iframe {
	width: 40%;
	position: absolute;
	top: 50px;
	right: 20px;
	height: 300px;
	border: 1px solid black;
}
</style>

<!-- for codemirror -->
<script type="text/javascript" src=codemirror/lib/codemirror.js></script>
<script type="text/javascript" src=codemirror/mode/xml/xml.js></script>
<script type="text/javascript" src=codemirror/mode/javascript/javascript.js></script>
<script type="text/javascript" src=codemirror/mode/css/css.js></script>
<script type="text/javascript" src=codemirror/mode/htmlmixed/htmlmixed.js></script>
<link rel=stylesheet href=codemirror/lib/codemirror.css>
<link rel="stylesheet" href="codemirror/theme/default.css">
<script type="text/javascript">
<!--
var editor;
$(function(){
	var delay;
    editor = CodeMirror.fromTextArea(document.getElementById("textarea_html"), {
      mode: 'text/html',
      tabMode: 'indent',
      lineNumbers: 'true',
      onChange: function() {
        clearTimeout(delay);
        delay = setTimeout(updatePreview, 300);
      }
    });
    
    var httpObj = $.get("html_template.txt", null, function(){
    	 editor.setValue(httpObj.responseText);
    });
    
    function updatePreview() {
      var previewFrame = document.getElementById('preview_html');
      var preview =  previewFrame.contentDocument ||  previewFrame.contentWindow.document;
      preview.open();
      preview.write(editor.getValue());
      preview.close();
    }
    setTimeout(updatePreview, 300);
});

function getHTMLCode() {
	  alert(editor.getValue());
}
//-->
</script>
</head>
<body>
	<h1>Cauliflower v0.1</h1>
	<div id="tabs">
		<ul>
			<li><a href="#tab-javascript">JavaScript</a></li>
			<li><a href="#tab-html">HTML</a></li>
		</ul>
		<div id="tab-javascript">
			<p>ここにはBlockyを表示させます。</p>
		</div>
		<div id="tab-html">
			<p>
				<a href="javascript:getHTMLCode();">テスト用：HTMLを取得</a>
			</p>
			<p>TODO:Chromeは外部ファイルアクセス禁止なので、最終的にテンプレートはURL読み込みにする。</p>
			<textarea id="textarea_html"></textarea>
			<iframe id=preview_html></iframe>
		</div>
	</div>
</body>
</html>